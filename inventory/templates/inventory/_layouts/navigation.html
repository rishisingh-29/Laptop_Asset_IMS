{% load static %}
{% load auth_extras %}

<!-- Sidebar Navigation -->
<aside id="sidebar" class="mobile-sidebar fixed lg:static inset-y-0 left-0 z-40 w-64 bg-white dark:bg-gray-800 shadow-xl flex flex-col transition-transform duration-300">
    
    <!-- Sidebar Header -->
    <div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700">
        <a href="{% url 'inventory:dashboard' %}" class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center shadow-lg">
                <i class="fas fa-building text-white text-lg"></i>
            </div>
            <div>
                <h2 class="text-lg font-bold text-gray-800 dark:text-white">OYO Assets</h2>
            </div>
        </a>
        
        <!-- Close Button (Mobile Only) -->
        <button id="close-sidebar-btn" class="lg:hidden text-gray-500 dark:text-gray-400 hover:text-purple-600 focus:outline-none">
            <i class="fas fa-times text-xl"></i>
        </button>
    </div>

    <!-- Navigation Menu -->
    <nav class="flex-1 overflow-y-auto p-4">
        <ul class="space-y-2">
            
            <!-- Dashboard (Visible to All Logged-in Users) -->
            <li>
                <a href="{% url 'inventory:dashboard' %}" 
                   class="flex items-center px-4 py-2.5 text-gray-700 dark:text-gray-300 rounded-lg transition-colors duration-200 hover:bg-purple-100 dark:hover:bg-gray-700 hover:text-purple-600 
                          {% if request.resolver_match.url_name == 'dashboard' %}bg-purple-100 dark:bg-gray-700 text-purple-600 font-semibold{% endif %}">
                    <i class="fas fa-home w-5 text-center mr-3"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            
            <!-- Asset Management Section (Visible to IT_Admin & Super_Admin) -->
            {% if request.user.is_superuser or request.user|has_group:"IT_Admin" %}
            <li class="pt-4 pb-2 px-4">
                <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Management</p>
            </li>
            <li>
                <a href="{% url 'inventory:asset_list' %}" 
                   class="flex items-center px-4 py-2.5 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-purple-100 dark:hover:bg-gray-700 hover:text-purple-600
                          {% if 'asset' in request.resolver_match.url_name %}bg-purple-100 dark:bg-gray-700 text-purple-600 font-semibold{% endif %}">
                    <i class="fas fa-box w-5 text-center mr-3"></i> <span>Assets</span>
                </a>
            </li>
            <li>
                <a href="{% url 'inventory:allocation_list' %}" 
                   class="flex items-center px-4 py-2.5 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-purple-100 dark:hover:bg-gray-700 hover:text-purple-600
                          {% if 'allocation' in request.resolver_match.url_name %}bg-purple-100 dark:bg-gray-700 text-purple-600 font-semibold{% endif %}">
                    <i class="fas fa-exchange-alt w-5 text-center mr-3"></i> <span>Transactions</span>
                </a>
            </li>
            <li>
                <a href="{% url 'inventory:transaction_search' %}" 
                   class="flex items-center px-4 py-2.5 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-purple-100 dark:hover:bg-gray-700 hover:text-purple-600
                          {% if request.resolver_match.url_name == 'transaction_search' %}bg-purple-100 dark:bg-gray-700 text-purple-600 font-semibold{% endif %}">
                    <i class="fas fa-search w-5 text-center mr-3"></i> <span>Know Transaction</span>
                </a>
            </li>
            <li>
                <a href="{% url 'inventory:audit_log_viewer' %}" 
                   class="flex items-center px-4 py-2.5 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-purple-100 dark:hover:bg-gray-700 hover:text-purple-600
                          {% if request.resolver_match.url_name == 'audit_log_viewer' %}bg-purple-100 dark:bg-gray-700 text-purple-600 font-semibold{% endif %}">
                    <i class="fas fa-clipboard-list w-5 text-center mr-3"></i> <span>Audit Log</span>
                </a>
            </li>
            {% endif %}

            <!-- Administration Section (Visible to Super_Admin Only) -->
            {% if request.user.is_superuser %}
            <li class="pt-4 pb-2 px-4">
                <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Administration</p>
            </li>
            <li>
                <a href="{% url 'inventory:employee_list' %}" 
                   class="flex items-center px-4 py-2.5 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-purple-100 dark:hover:bg-gray-700 hover:text-purple-600
                          {% if 'employee' in request.resolver_match.url_name %}bg-purple-100 dark:bg-gray-700 text-purple-600 font-semibold{% endif %}">
                    <i class="fas fa-users-cog w-5 text-center mr-3"></i> <span>Employees</span>
                </a>
            </li>
            <li>
                <a href="{% url 'admin:index' %}" target="_blank" 
                   class="flex items-center px-4 py-2.5 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-purple-100 dark:hover:bg-gray-700 hover:text-purple-600">
                    <i class="fas fa-cogs w-5 text-center mr-3"></i> <span>Admin Panel</span>
                    <i class="fas fa-external-link-alt text-xs ml-auto"></i>
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>

    <!-- User Profile Section -->
    <div class="border-t border-gray-200 dark:border-gray-700 p-4">
        <div class="flex items-center space-x-3 mb-4">
            <img class="w-10 h-10 rounded-full object-cover" src="{% static 'inventory/images/download.jpg' %}" alt="Profile">
            <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-gray-800 dark:text-white truncate">
                    {{ request.user.employee_profile.full_name|default:request.user.username }}
                </p>
                <p class="text-xs text-gray-500 dark:text-gray-400 truncate">
                    {{ request.user.email }}
                </p>
            </div>
        </div>
        <a href="{% url 'inventory:logout' %}" 
           class="flex items-center justify-center w-full px-4 py-2 bg-red-50 dark:bg-red-900/30 hover:bg-red-100 dark:hover:bg-red-900/50 text-red-600 dark:text-red-300 rounded-lg font-medium transition-colors duration-200">
            <i class="fas fa-sign-out-alt w-5 text-center mr-2"></i>
            <span>Logout</span>
        </a>
    </div>
</aside>